timestamp: 2026-01-18T22:26:59.996609+01:00
session: true
header: run.sh batch



----- RUN RECORD -----
timestamp: 2026-01-18T22:27:09.467461+01:00
source: graph_rag

Question:
What is our current event streaming platform, and which ADR superseded the previous one? (ids + dates)

Answer:
- Current event streaming platform: ADR-0005 — Switch to Cloud Pub/Sub (Date: 2023-06-05)
- ADR that superseded the previous one: ADR-0005 supersedes ADR-0001 (ADR-0001 date: 2022-09-14)


----- RUN RECORD -----
timestamp: 2026-01-18T22:27:25.874403+01:00
source: rag

Question:
What is our current event streaming platform, and which ADR superseded the previous one? (ids + dates)

Answer:
- Current event streaming platform: Cloud Pub/Sub. ADR: ADR-0005: Switch to Cloud Pub/Sub, dated 2023-06-05. This ADR supersedes ADR-0001 (Use Kafka for Event Streaming), which is dated 2022-09-14.


----- RUN RECORD -----
timestamp: 2026-01-18T22:27:33.635877+01:00
source: graph_rag

Question:
Given we switched to Pub/Sub, what ADR(s) still govern event contract/schema governance, and what tooling do we use?

Answer:
- ADRs governing event contract/schema governance: ADR-0008: Introduce Schema Registry for Event Contracts. This ADR establishes using a schema registry and Avro schemas to govern event contracts, with compatibility checks enforced in CI/CD.

- Tooling used: Confluent Schema Registry (with Avro schemas) for all events, plus CI/CD compatibility checks to enforce schema evolution rules.


----- RUN RECORD -----
timestamp: 2026-01-18T22:27:53.431020+01:00
source: rag

Question:
Given we switched to Pub/Sub, what ADR(s) still govern event contract/schema governance, and what tooling do we use?

Answer:
- ADR governing event contract/schema governance
  - ADR-0008: Introduce Schema Registry for Event Contracts. It specifies using Confluent Schema Registry with Avro schemas for all events and enforcing compatibility checks in CI/CD pipelines. This is the current governance artifact for event contracts and schema evolution. 

- How this fits with the Pub/Sub switch
  - We switched the event streaming platform to Pub/Sub under ADR-0005: Switch to Cloud Pub/Sub. This confirms Pub/Sub as the event backbone, while ADR-0008 governs the event contract/schema layer on top of it. 

- Tooling used for event contract/schema governance
  - Confluent Schema Registry with Avro schemas for all events.
  - CI/CD pipeline checks to enforce schema compatibility. 

In short: after moving to Pub/Sub, ADR-0008 remains the governing ADR for event contract/schema governance, and we use Confluent Schema Registry (Avro) with CI/CD compatibility checks as the tooling. ADR-0005 covers the Pub/Sub switch itself.


----- RUN RECORD -----
timestamp: 2026-01-18T22:28:15.721352+01:00
source: graph_rag

Question:
Which ADRs are related to service-to-service auth?

Answer:
Here are the ADRs in the provided material that relate to service-to-service authentication:

- ADR-0003: Service-to-Service Authentication with OAuth2 — the core ADR for this topic.
- ADR-0007: Deprecate mTLS Authentication — amends ADR-0003 (moving to OAuth2-only).
- ADR-0011: Define Auth Trust Graph and Service Call Policy — amends ADR-0003; also related to ADR-0007 and ADR-0004.
- ADR-0009: Define Service Ownership and Dependency Map — related to ADR-0003 (touches on service-to-service authorization decisions).

Optionally (for lineage/metadata context):
- ADR-0010: Establish ADR Lineage (Supersedes/Amends) Metadata — provides lineage context that includes ADRs like ADR-0003.


----- RUN RECORD -----
timestamp: 2026-01-18T22:28:45.253711+01:00
source: rag

Question:
Which ADRs are related to service-to-service auth?

Answer:
Here are the ADRs directly related to service-to-service authentication/authorisation:

- ADR-0003: Service-to-Service Authentication with OAuth2 — the core approach for how services authenticate and authorize with OAuth2 (Client Credentials) and how tokens are injected by sidecar proxies. 

- ADR-0007: Deprecate mTLS Authentication — amends ADR-0003 to move away from mTLS in favor of OAuth2-only authentication. 

- ADR-0011: Define Auth Trust Graph and Service Call Policy — formalizes a trust graph for service-to-service calls and the associated policy, and amends ADR-0003. 

- Related pointer: ADR-0004 (Adopt API Gateway) notes that service-to-service requests are authenticated by OAuth2 and references ADR-0003 and ADR-0007, showing how these ADRs interrelate. 

If you want, I can summarize the exact decisions and implications of each ADR.


----- RUN RECORD -----
timestamp: 2026-01-18T22:28:54.841410+01:00
source: graph_rag

Question:
Which services are impacted by auth decisions?

Answer:
- api-gateway
- order-service
- inventory-service
- billing-service
- notification-service

These are the services represented in the explicit trust graph and are the ones involved in the service-to-service authorization decisions (e.g., api-gateway -> order-service, order-service -> inventory-service, order-service -> billing-service, billing-service -> notification-service).


----- RUN RECORD -----
timestamp: 2026-01-18T22:29:08.280441+01:00
source: rag

Question:
Which services are impacted by auth decisions?

Answer:
The services impacted are: api-gateway, order-service, inventory-service, billing-service, and notification-service.


----- RUN RECORD -----
timestamp: 2026-01-18T22:29:26.805111+01:00
source: graph_rag

Question:
Timeline of messaging platform decisions?

Answer:
Here’s a concise timeline of the messaging platform decisions, based on the ADRs in the provided docs:

- 2022-09-14 — ADR-0001: Use Kafka for Event Streaming
  - Decision: Adopt Apache Kafka as the event streaming backbone ( Kubernetes deployment with Confluent for Kubernetes).
  - Consequences: High operational overhead, strong ecosystem, enables event replay/retention; requires training.
  - Status: Accepted; later superseded by ADR-0005.
  - Relation: This was the initial decision before switching to Pub/Sub.

- 2023-06-05 — ADR-0005: Switch to Cloud Pub/Sub
  - Decision: Switch from Apache Kafka to Cloud Pub/Sub as the event streaming platform.
  - Consequences: Reduced operational complexity; easier cloud integration; risk of vendor lock-in; migration effort needed.
  - Alternatives: Continue with self-managed Kafka (rejected), Confluent Cloud Kafka (rejected).
  - Status: Accepted; supersedes ADR-0001.
  - Relation: Governs the current event streaming platform.

- 2024-01-17 — ADR-0010: Establish ADR Lineage (Supersedes/Amends) Metadata
  - Decision: Establish explicit ADR lineage metadata to document supersedes/amends/relations among ADRs.
  - Relevance to messaging: References ADR-0001 and ADR-0005 to maintain traceability of decisions about event streaming.
  - Status: Accepted; builds governance around ADRs including the messaging platform decision.

Current state (as per the lineage and governing ADRs):
- The governing messaging platform decision is ADR-0005: Switch to Cloud Pub/Sub (Cloud Pub/Sub is the event streaming platform now).

In short: Kafka was chosen in 2022 (ADR-0001), but in 2023 the decision flipped to Cloud Pub/Sub (ADR-0005), which remains the current approach, with ADR-0010 ensuring proper lineage and traceability of these decisions.


----- RUN RECORD -----
timestamp: 2026-01-18T22:29:57.040111+01:00
source: rag

Question:
Timeline of messaging platform decisions?

Answer:
Here’s a concise, chronological timeline of the messaging platform decisions based on the ADRs in your docs:

- 2022-09-14: ADR-0001 – Use Kafka for Event Streaming. Accepted as the initial messaging backbone. Superseded later by ADR-0005. 
- 2023-01-20: ADR-0003 – Service-to-Service Authentication with OAuth2 (Keycloak as IdP). Establishes secure service communication. Amended later by ADR-0007 and ADR-0011. 
- 2023-02-15: ADR-0004 – Adopt API Gateway for External Traffic (Kong as single entry point). Centralizes cross-cutting concerns like auth. 
- 2023-06-05: ADR-0005 – Switch to Cloud Pub/Sub (from Kafka). Reduces operational overhead; supersedes ADR-0001. 
- 2023-09-12: ADR-0007 – Deprecate mTLS Authentication (in favor of OAuth2). Simplifies auth but amends ADR-0003. 
- 2023-10-20: ADR-0008 – Introduce Schema Registry for Event Contracts (Confluent Schema Registry with Avro). Enforces compatibility and governance. 
- 2024-01-10: ADR-0009 – Define Service Ownership and Dependency Map. Expands governance around services and messaging flows. 
- 2024-01-17: ADR-0010 – Establish ADR Lineage (Supersedes/Amends) Metadata. Documents and traces ADR lineage (related to 0001/0005). 
- 2024-02-01: ADR-0011 – Define Auth Trust Graph and Service Call Policy. Explicitly documents trust relationships and policy for service calls; amends ADR-0003. 

If you’d like, I can expand each entry with key quotes or decisions from the ADR documents.
